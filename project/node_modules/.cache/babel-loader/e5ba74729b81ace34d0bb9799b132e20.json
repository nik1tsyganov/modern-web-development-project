{"ast":null,"code":"/**\r\n * Work around Safari 14 IndexedDB open bug.\r\n *\r\n * Safari has a horrible bug where IDB requests can hang while the browser is starting up. https://bugs.webkit.org/show_bug.cgi?id=226547\r\n * The only solution is to keep nudging it until it's awake.\r\n */\nfunction idbReady() {\n  var isSafari = !navigator.userAgentData && /Safari\\//.test(navigator.userAgent) && !/Chrom(e|ium)\\//.test(navigator.userAgent); // No point putting other browsers or older versions of Safari through this mess.\n\n  if (!isSafari || !indexedDB.databases) return Promise.resolve();\n  var intervalId;\n  return new Promise(function (resolve) {\n    var tryIdb = function tryIdb() {\n      return indexedDB.databases().finally(resolve);\n    };\n\n    intervalId = setInterval(tryIdb, 100);\n    tryIdb();\n  }).finally(function () {\n    return clearInterval(intervalId);\n  });\n}\n\nexport default idbReady;","map":null,"metadata":{},"sourceType":"module"}