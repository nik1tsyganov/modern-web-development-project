{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\n\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\n\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\n\nvar _promiseUtils = require(\"./promiseUtils\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var _context4, _context5;\n\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? _forEachInstanceProperty(_context4 = ownKeys(Object(source), !0)).call(_context4, function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context5 = ownKeys(Object(source))).call(_context5, function (key) {\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n/**\r\n * Copyright (c) 2015-present, Parse, LLC.\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree. An additional grant\r\n * of patent rights can be found in the PATENTS file in the same directory.\r\n *\r\n * @flow\r\n */\n\n/* global XMLHttpRequest, XDomainRequest */\n\n\nvar uuidv4 = require('./uuid');\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar useXDomainRequest = false;\n\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\n  useXDomainRequest = true;\n}\n\nfunction ajaxIE9(method\n/*: string*/\n, url\n/*: string*/\n, data\n/*: any*/\n, headers\n/*:: ?: any*/\n, options\n/*:: ?: FullOptions*/\n) {\n  return new _promise.default(function (resolve, reject) {\n    var xdr = new XDomainRequest();\n\n    xdr.onload = function () {\n      var response;\n\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        reject(e);\n      }\n\n      if (response) {\n        resolve({\n          response: response\n        });\n      }\n    };\n\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: (0, _stringify.default)({\n          code: _ParseError.default.X_DOMAIN_REQUEST,\n          error: \"IE's XDomainRequest does not supply error info.\"\n        })\n      };\n      reject(fakeResponse);\n    };\n\n    xdr.onprogress = function () {\n      if (options && typeof options.progress === 'function') {\n        options.progress(xdr.responseText);\n      }\n    };\n\n    xdr.open(method, url);\n    xdr.send(data);\n\n    if (options && typeof options.requestTask === 'function') {\n      options.requestTask(xdr);\n    }\n  });\n}\n\nvar RESTController = {\n  ajax: function (method\n  /*: string*/\n  , url\n  /*: string*/\n  , data\n  /*: any*/\n  , headers\n  /*:: ?: any*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    var _context;\n\n    if (useXDomainRequest) {\n      return ajaxIE9(method, url, data, headers, options);\n    }\n\n    var promise = (0, _promiseUtils.resolvingPromise)();\n    var isIdempotent = _CoreManager.default.get('IDEMPOTENCY') && (0, _includes.default)(_context = ['POST', 'PUT']).call(_context, method);\n    var requestId = isIdempotent ? uuidv4() : '';\n    var attempts = 0;\n\n    var dispatch = function dispatch() {\n      if (XHR == null) {\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\n      }\n\n      var handled = false;\n      var xhr = new XHR();\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\n          return;\n        }\n\n        handled = true;\n\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.responseText);\n\n            if (typeof xhr.getResponseHeader === 'function') {\n              var _context2, _context3;\n\n              if ((0, _includes.default)(_context2 = xhr.getAllResponseHeaders() || '').call(_context2, 'x-parse-job-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-job-status-id');\n              }\n\n              if ((0, _includes.default)(_context3 = xhr.getAllResponseHeaders() || '').call(_context3, 'x-parse-push-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-push-status-id');\n              }\n            }\n          } catch (e) {\n            promise.reject(e.toString());\n          }\n\n          if (response) {\n            promise.resolve({\n              response: response,\n              status: xhr.status,\n              xhr: xhr\n            });\n          }\n        } else if (xhr.status >= 500 || xhr.status === 0) {\n          // retry on 5XX or node-xmlhttprequest error\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\n            // Exponentially-growing random delay\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\n            (0, _setTimeout2.default)(dispatch, delay);\n          } else if (xhr.status === 0) {\n            promise.reject('Unable to connect to the Parse API');\n          } else {\n            // After the retry limit is reached, fail\n            promise.reject(xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      };\n\n      headers = headers || {};\n\n      if (typeof headers['Content-Type'] !== 'string') {\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\n      }\n\n      if (_CoreManager.default.get('IS_NODE')) {\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\n      }\n\n      if (isIdempotent) {\n        headers['X-Parse-Request-Id'] = requestId;\n      }\n\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\n      }\n\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\n\n      for (var key in customHeaders) {\n        headers[key] = customHeaders[key];\n      }\n\n      function handleProgress(type, event) {\n        if (options && typeof options.progress === 'function') {\n          if (event.lengthComputable) {\n            options.progress(event.loaded / event.total, event.loaded, event.total, {\n              type: type\n            });\n          } else {\n            options.progress(null, null, null, {\n              type: type\n            });\n          }\n        }\n      }\n\n      xhr.onprogress = function (event) {\n        handleProgress('download', event);\n      };\n\n      if (xhr.upload) {\n        xhr.upload.onprogress = function (event) {\n          handleProgress('upload', event);\n        };\n      }\n\n      xhr.open(method, url, true);\n\n      for (var h in headers) {\n        xhr.setRequestHeader(h, headers[h]);\n      }\n\n      xhr.onabort = function () {\n        promise.resolve({\n          response: {\n            results: []\n          },\n          status: 0,\n          xhr: xhr\n        });\n      };\n\n      xhr.send(data);\n\n      if (options && typeof options.requestTask === 'function') {\n        options.requestTask(xhr);\n      }\n    };\n\n    dispatch();\n    return promise;\n  },\n  request: function (method\n  /*: string*/\n  , path\n  /*: string*/\n  , data\n  /*: mixed*/\n  , options\n  /*:: ?: RequestOptions*/\n  ) {\n    options = options || {};\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += path;\n    var payload = {};\n\n    if (data && (0, _typeof2.default)(data) === 'object') {\n      for (var k in data) {\n        payload[k] = data[k];\n      }\n    } // Add context\n\n\n    var context = options.context;\n\n    if (context !== undefined) {\n      payload._context = context;\n    }\n\n    if (method !== 'POST') {\n      payload._method = method;\n      method = 'POST';\n    }\n\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\n\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\n\n    if (jsKey) {\n      payload._JavaScriptKey = jsKey;\n    }\n\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\n    var useMasterKey = options.useMasterKey;\n\n    if (typeof useMasterKey === 'undefined') {\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\n    }\n\n    if (useMasterKey) {\n      if (_CoreManager.default.get('MASTER_KEY')) {\n        delete payload._JavaScriptKey;\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\n      } else {\n        throw new Error('Cannot use the Master Key, it has not been provided.');\n      }\n    }\n\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\n      payload._RevocableSession = '1';\n    }\n\n    var installationId = options.installationId;\n    var installationIdPromise;\n\n    if (installationId && typeof installationId === 'string') {\n      installationIdPromise = _promise.default.resolve(installationId);\n    } else {\n      var installationController = _CoreManager.default.getInstallationController();\n\n      installationIdPromise = installationController.currentInstallationId();\n    }\n\n    return installationIdPromise.then(function (iid) {\n      payload._InstallationId = iid;\n\n      var userController = _CoreManager.default.getUserController();\n\n      if (options && typeof options.sessionToken === 'string') {\n        return _promise.default.resolve(options.sessionToken);\n      } else if (userController) {\n        return userController.currentUserAsync().then(function (user) {\n          if (user) {\n            return _promise.default.resolve(user.getSessionToken());\n          }\n\n          return _promise.default.resolve(null);\n        });\n      }\n\n      return _promise.default.resolve(null);\n    }).then(function (token) {\n      if (token) {\n        payload._SessionToken = token;\n      }\n\n      var payloadString = (0, _stringify.default)(payload);\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\n        var response = _ref.response,\n            status = _ref.status;\n\n        if (options.returnStatus) {\n          return _objectSpread(_objectSpread({}, response), {}, {\n            _status: status\n          });\n        } else {\n          return response;\n        }\n      });\n    }).catch(RESTController.handleError);\n  },\n  handleError: function (response) {\n    // Transform the error into an instance of ParseError by trying to parse\n    // the error string as JSON\n    var error;\n\n    if (response && response.responseText) {\n      try {\n        var errorJSON = JSON.parse(response.responseText);\n        error = new _ParseError.default(errorJSON.code, errorJSON.error);\n      } catch (e) {\n        // If we fail to parse the error text, that's okay.\n        error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\n      }\n    } else {\n      var message = response.message ? response.message : response;\n      error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(message));\n    }\n\n    return _promise.default.reject(error);\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  },\n  _getXHR: function () {\n    return XHR;\n  }\n};\nmodule.exports = RESTController;","map":{"version":3,"names":["_interopRequireDefault","require","_Object$defineProperty","_Object$defineProperties","_Object$getOwnPropertyDescriptors","_forEachInstanceProperty","_Object$getOwnPropertyDescriptor","_filterInstanceProperty","_Object$getOwnPropertySymbols","_Object$keys","_defineProperty2","_typeof2","_setTimeout2","_includes","_stringify","_promise","_CoreManager","_ParseError","_promiseUtils","ownKeys","object","enumerableOnly","keys","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","_context4","_context5","source","Object","key","default","uuidv4","XHR","XMLHttpRequest","useXDomainRequest","XDomainRequest","ajaxIE9","method","url","data","headers","options","resolve","reject","xdr","onload","response","JSON","parse","responseText","e","onerror","ontimeout","fakeResponse","code","X_DOMAIN_REQUEST","error","onprogress","progress","open","send","requestTask","RESTController","ajax","_context","promise","resolvingPromise","isIdempotent","get","requestId","attempts","dispatch","Error","handled","xhr","onreadystatechange","readyState","_aborted","status","getResponseHeader","_context2","_context3","getAllResponseHeaders","toString","delay","Math","round","random","pow","process","versions","node","customHeaders","handleProgress","type","event","lengthComputable","loaded","total","upload","h","setRequestHeader","onabort","results","request","path","payload","k","context","undefined","_method","_ApplicationId","jsKey","_JavaScriptKey","_ClientVersion","useMasterKey","_MasterKey","_RevocableSession","installationId","installationIdPromise","installationController","getInstallationController","currentInstallationId","then","iid","_InstallationId","userController","getUserController","sessionToken","currentUserAsync","user","getSessionToken","token","_SessionToken","payloadString","_ref","returnStatus","_status","catch","handleError","errorJSON","INVALID_JSON","message","CONNECTION_FAILED","_setXHR","_getXHR","module","exports"],"sources":["C:/Users/brosk/Documents/Web Dev/modern-web-development-project/project/node_modules/parse/lib/browser/RESTController.js"],"sourcesContent":["\"use strict\";\r\n\r\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\r\n\r\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\r\n\r\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\r\n\r\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\r\n\r\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\r\n\r\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\r\n\r\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\r\n\r\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\r\n\r\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\r\n\r\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\r\n\r\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\r\n\r\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\r\n\r\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\r\n\r\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\r\n\r\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\r\n\r\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\r\n\r\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\r\n\r\nvar _promiseUtils = require(\"./promiseUtils\");\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n  var keys = _Object$keys(object);\r\n\r\n  if (_Object$getOwnPropertySymbols) {\r\n    var symbols = _Object$getOwnPropertySymbols(object);\r\n\r\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\r\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\r\n    })), keys.push.apply(keys, symbols);\r\n  }\r\n\r\n  return keys;\r\n}\r\n\r\nfunction _objectSpread(target) {\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    var _context4, _context5;\r\n\r\n    var source = null != arguments[i] ? arguments[i] : {};\r\n    i % 2 ? _forEachInstanceProperty(_context4 = ownKeys(Object(source), !0)).call(_context4, function (key) {\r\n      (0, _defineProperty2.default)(target, key, source[key]);\r\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context5 = ownKeys(Object(source))).call(_context5, function (key) {\r\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\r\n    });\r\n  }\r\n\r\n  return target;\r\n}\r\n/**\r\n * Copyright (c) 2015-present, Parse, LLC.\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree. An additional grant\r\n * of patent rights can be found in the PATENTS file in the same directory.\r\n *\r\n * @flow\r\n */\r\n\r\n/* global XMLHttpRequest, XDomainRequest */\r\n\r\n\r\nvar uuidv4 = require('./uuid');\r\n\r\nvar XHR = null;\r\n\r\nif (typeof XMLHttpRequest !== 'undefined') {\r\n  XHR = XMLHttpRequest;\r\n}\r\n\r\nvar useXDomainRequest = false;\r\n\r\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\r\n  useXDomainRequest = true;\r\n}\r\n\r\nfunction ajaxIE9(method\r\n/*: string*/\r\n, url\r\n/*: string*/\r\n, data\r\n/*: any*/\r\n, headers\r\n/*:: ?: any*/\r\n, options\r\n/*:: ?: FullOptions*/\r\n) {\r\n  return new _promise.default(function (resolve, reject) {\r\n    var xdr = new XDomainRequest();\r\n\r\n    xdr.onload = function () {\r\n      var response;\r\n\r\n      try {\r\n        response = JSON.parse(xdr.responseText);\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n\r\n      if (response) {\r\n        resolve({\r\n          response: response\r\n        });\r\n      }\r\n    };\r\n\r\n    xdr.onerror = xdr.ontimeout = function () {\r\n      // Let's fake a real error message.\r\n      var fakeResponse = {\r\n        responseText: (0, _stringify.default)({\r\n          code: _ParseError.default.X_DOMAIN_REQUEST,\r\n          error: \"IE's XDomainRequest does not supply error info.\"\r\n        })\r\n      };\r\n      reject(fakeResponse);\r\n    };\r\n\r\n    xdr.onprogress = function () {\r\n      if (options && typeof options.progress === 'function') {\r\n        options.progress(xdr.responseText);\r\n      }\r\n    };\r\n\r\n    xdr.open(method, url);\r\n    xdr.send(data);\r\n\r\n    if (options && typeof options.requestTask === 'function') {\r\n      options.requestTask(xdr);\r\n    }\r\n  });\r\n}\r\n\r\nvar RESTController = {\r\n  ajax: function (method\r\n  /*: string*/\r\n  , url\r\n  /*: string*/\r\n  , data\r\n  /*: any*/\r\n  , headers\r\n  /*:: ?: any*/\r\n  , options\r\n  /*:: ?: FullOptions*/\r\n  ) {\r\n    var _context;\r\n\r\n    if (useXDomainRequest) {\r\n      return ajaxIE9(method, url, data, headers, options);\r\n    }\r\n\r\n    var promise = (0, _promiseUtils.resolvingPromise)();\r\n    var isIdempotent = _CoreManager.default.get('IDEMPOTENCY') && (0, _includes.default)(_context = ['POST', 'PUT']).call(_context, method);\r\n    var requestId = isIdempotent ? uuidv4() : '';\r\n    var attempts = 0;\r\n\r\n    var dispatch = function dispatch() {\r\n      if (XHR == null) {\r\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\r\n      }\r\n\r\n      var handled = false;\r\n      var xhr = new XHR();\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\r\n          return;\r\n        }\r\n\r\n        handled = true;\r\n\r\n        if (xhr.status >= 200 && xhr.status < 300) {\r\n          var response;\r\n\r\n          try {\r\n            response = JSON.parse(xhr.responseText);\r\n\r\n            if (typeof xhr.getResponseHeader === 'function') {\r\n              var _context2, _context3;\r\n\r\n              if ((0, _includes.default)(_context2 = xhr.getAllResponseHeaders() || '').call(_context2, 'x-parse-job-status-id: ')) {\r\n                response = xhr.getResponseHeader('x-parse-job-status-id');\r\n              }\r\n\r\n              if ((0, _includes.default)(_context3 = xhr.getAllResponseHeaders() || '').call(_context3, 'x-parse-push-status-id: ')) {\r\n                response = xhr.getResponseHeader('x-parse-push-status-id');\r\n              }\r\n            }\r\n          } catch (e) {\r\n            promise.reject(e.toString());\r\n          }\r\n\r\n          if (response) {\r\n            promise.resolve({\r\n              response: response,\r\n              status: xhr.status,\r\n              xhr: xhr\r\n            });\r\n          }\r\n        } else if (xhr.status >= 500 || xhr.status === 0) {\r\n          // retry on 5XX or node-xmlhttprequest error\r\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\r\n            // Exponentially-growing random delay\r\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\r\n            (0, _setTimeout2.default)(dispatch, delay);\r\n          } else if (xhr.status === 0) {\r\n            promise.reject('Unable to connect to the Parse API');\r\n          } else {\r\n            // After the retry limit is reached, fail\r\n            promise.reject(xhr);\r\n          }\r\n        } else {\r\n          promise.reject(xhr);\r\n        }\r\n      };\r\n\r\n      headers = headers || {};\r\n\r\n      if (typeof headers['Content-Type'] !== 'string') {\r\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\r\n      }\r\n\r\n      if (_CoreManager.default.get('IS_NODE')) {\r\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\r\n      }\r\n\r\n      if (isIdempotent) {\r\n        headers['X-Parse-Request-Id'] = requestId;\r\n      }\r\n\r\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\r\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\r\n      }\r\n\r\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\r\n\r\n      for (var key in customHeaders) {\r\n        headers[key] = customHeaders[key];\r\n      }\r\n\r\n      function handleProgress(type, event) {\r\n        if (options && typeof options.progress === 'function') {\r\n          if (event.lengthComputable) {\r\n            options.progress(event.loaded / event.total, event.loaded, event.total, {\r\n              type: type\r\n            });\r\n          } else {\r\n            options.progress(null, null, null, {\r\n              type: type\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      xhr.onprogress = function (event) {\r\n        handleProgress('download', event);\r\n      };\r\n\r\n      if (xhr.upload) {\r\n        xhr.upload.onprogress = function (event) {\r\n          handleProgress('upload', event);\r\n        };\r\n      }\r\n\r\n      xhr.open(method, url, true);\r\n\r\n      for (var h in headers) {\r\n        xhr.setRequestHeader(h, headers[h]);\r\n      }\r\n\r\n      xhr.onabort = function () {\r\n        promise.resolve({\r\n          response: {\r\n            results: []\r\n          },\r\n          status: 0,\r\n          xhr: xhr\r\n        });\r\n      };\r\n\r\n      xhr.send(data);\r\n\r\n      if (options && typeof options.requestTask === 'function') {\r\n        options.requestTask(xhr);\r\n      }\r\n    };\r\n\r\n    dispatch();\r\n    return promise;\r\n  },\r\n  request: function (method\r\n  /*: string*/\r\n  , path\r\n  /*: string*/\r\n  , data\r\n  /*: mixed*/\r\n  , options\r\n  /*:: ?: RequestOptions*/\r\n  ) {\r\n    options = options || {};\r\n\r\n    var url = _CoreManager.default.get('SERVER_URL');\r\n\r\n    if (url[url.length - 1] !== '/') {\r\n      url += '/';\r\n    }\r\n\r\n    url += path;\r\n    var payload = {};\r\n\r\n    if (data && (0, _typeof2.default)(data) === 'object') {\r\n      for (var k in data) {\r\n        payload[k] = data[k];\r\n      }\r\n    } // Add context\r\n\r\n\r\n    var context = options.context;\r\n\r\n    if (context !== undefined) {\r\n      payload._context = context;\r\n    }\r\n\r\n    if (method !== 'POST') {\r\n      payload._method = method;\r\n      method = 'POST';\r\n    }\r\n\r\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\r\n\r\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\r\n\r\n    if (jsKey) {\r\n      payload._JavaScriptKey = jsKey;\r\n    }\r\n\r\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\r\n    var useMasterKey = options.useMasterKey;\r\n\r\n    if (typeof useMasterKey === 'undefined') {\r\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\r\n    }\r\n\r\n    if (useMasterKey) {\r\n      if (_CoreManager.default.get('MASTER_KEY')) {\r\n        delete payload._JavaScriptKey;\r\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\r\n      } else {\r\n        throw new Error('Cannot use the Master Key, it has not been provided.');\r\n      }\r\n    }\r\n\r\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\r\n      payload._RevocableSession = '1';\r\n    }\r\n\r\n    var installationId = options.installationId;\r\n    var installationIdPromise;\r\n\r\n    if (installationId && typeof installationId === 'string') {\r\n      installationIdPromise = _promise.default.resolve(installationId);\r\n    } else {\r\n      var installationController = _CoreManager.default.getInstallationController();\r\n\r\n      installationIdPromise = installationController.currentInstallationId();\r\n    }\r\n\r\n    return installationIdPromise.then(function (iid) {\r\n      payload._InstallationId = iid;\r\n\r\n      var userController = _CoreManager.default.getUserController();\r\n\r\n      if (options && typeof options.sessionToken === 'string') {\r\n        return _promise.default.resolve(options.sessionToken);\r\n      } else if (userController) {\r\n        return userController.currentUserAsync().then(function (user) {\r\n          if (user) {\r\n            return _promise.default.resolve(user.getSessionToken());\r\n          }\r\n\r\n          return _promise.default.resolve(null);\r\n        });\r\n      }\r\n\r\n      return _promise.default.resolve(null);\r\n    }).then(function (token) {\r\n      if (token) {\r\n        payload._SessionToken = token;\r\n      }\r\n\r\n      var payloadString = (0, _stringify.default)(payload);\r\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\r\n        var response = _ref.response,\r\n            status = _ref.status;\r\n\r\n        if (options.returnStatus) {\r\n          return _objectSpread(_objectSpread({}, response), {}, {\r\n            _status: status\r\n          });\r\n        } else {\r\n          return response;\r\n        }\r\n      });\r\n    }).catch(RESTController.handleError);\r\n  },\r\n  handleError: function (response) {\r\n    // Transform the error into an instance of ParseError by trying to parse\r\n    // the error string as JSON\r\n    var error;\r\n\r\n    if (response && response.responseText) {\r\n      try {\r\n        var errorJSON = JSON.parse(response.responseText);\r\n        error = new _ParseError.default(errorJSON.code, errorJSON.error);\r\n      } catch (e) {\r\n        // If we fail to parse the error text, that's okay.\r\n        error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\r\n      }\r\n    } else {\r\n      var message = response.message ? response.message : response;\r\n      error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(message));\r\n    }\r\n\r\n    return _promise.default.reject(error);\r\n  },\r\n  _setXHR: function (xhr\r\n  /*: any*/\r\n  ) {\r\n    XHR = xhr;\r\n  },\r\n  _getXHR: function () {\r\n    return XHR;\r\n  }\r\n};\r\nmodule.exports = RESTController;"],"mappings":"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"},"metadata":{},"sourceType":"script"}