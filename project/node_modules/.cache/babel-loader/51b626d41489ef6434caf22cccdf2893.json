{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Array$isArray2 = require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\");\n\nvar _getIteratorMethod = require(\"@babel/runtime-corejs3/core-js/get-iterator-method\");\n\nvar _Symbol = require(\"@babel/runtime-corejs3/core-js-stable/symbol\");\n\nvar _Array$from2 = require(\"@babel/runtime-corejs3/core-js-stable/array/from\");\n\nvar _sliceInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\");\n\nvar _find = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/find\"));\n\nvar _from = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/from\"));\n\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\n\nvar _keys2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/keys\"));\n\nvar _startsWith = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/starts-with\"));\n\nvar _keys3 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\n\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _set = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/toConsumableArray\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\n\nvar _LocalDatastoreUtils = require(\"./LocalDatastoreUtils\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof _Symbol !== \"undefined\" && _getIteratorMethod(o) || o[\"@@iterator\"];\n\n  if (!it) {\n    if (_Array$isArray2(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  var _context18;\n\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n\n  var n = _sliceInstanceProperty(_context18 = Object.prototype.toString.call(o)).call(_context18, 8, -1);\n\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return _Array$from2(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n/**\r\n * Provides a local datastore which can be used to store and retrieve <code>Parse.Object</code>. <br />\r\n * To enable this functionality, call <code>Parse.enableLocalDatastore()</code>.\r\n *\r\n * Pin object to add to local datastore\r\n *\r\n * <pre>await object.pin();</pre>\r\n * <pre>await object.pinWithName('pinName');</pre>\r\n *\r\n * Query pinned objects\r\n *\r\n * <pre>query.fromLocalDatastore();</pre>\r\n * <pre>query.fromPin();</pre>\r\n * <pre>query.fromPinWithName();</pre>\r\n *\r\n * <pre>const localObjects = await query.find();</pre>\r\n *\r\n * @class Parse.LocalDatastore\r\n * @static\r\n */\n\n\nvar LocalDatastore = {\n  isEnabled: false,\n  isSyncing: false,\n  fromPinWithName: function (name\n  /*: string*/\n  )\n  /*: Promise<Array<Object>>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.fromPinWithName(name);\n  },\n  pinWithName: function (name\n  /*: string*/\n  , value\n  /*: any*/\n  )\n  /*: Promise<void>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.pinWithName(name, value);\n  },\n  unPinWithName: function (name\n  /*: string*/\n  )\n  /*: Promise<void>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.unPinWithName(name);\n  },\n  _getAllContents: function ()\n  /*: Promise<Object>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.getAllContents();\n  },\n  // Use for testing\n  _getRawStorage: function ()\n  /*: Promise<Object>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.getRawStorage();\n  },\n  _clear: function ()\n  /*: Promise<void>*/\n  {\n    var controller = _CoreManager.default.getLocalDatastoreController();\n\n    return controller.clear();\n  },\n  // Pin the object and children recursively\n  // Saves the object and children key to Pin Name\n  _handlePinAllWithName: function (name\n  /*: string*/\n  , objects\n  /*: Array<ParseObject>*/\n  )\n  /*: Promise<void>*/\n  {\n    var _this = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n      var _context;\n\n      var pinName, toPinPromises, objectKeys, _iterator, _step, parent, children, parentKey, json, objectKey, fromPinPromise, _yield$Promise$all, _yield$Promise$all2, pinned, toPin;\n\n      return _regenerator.default.wrap(function (_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              pinName = _this.getPinName(name);\n              toPinPromises = [];\n              objectKeys = [];\n              _iterator = _createForOfIteratorHelper(objects);\n\n              try {\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                  parent = _step.value;\n                  children = _this._getChildren(parent);\n                  parentKey = _this.getKeyForObject(parent);\n                  json = parent._toFullJSON(undefined, true);\n\n                  if (parent._localId) {\n                    json._localId = parent._localId;\n                  }\n\n                  children[parentKey] = json;\n\n                  for (objectKey in children) {\n                    objectKeys.push(objectKey);\n                    toPinPromises.push(_this.pinWithName(objectKey, [children[objectKey]]));\n                  }\n                }\n              } catch (err) {\n                _iterator.e(err);\n              } finally {\n                _iterator.f();\n              }\n\n              fromPinPromise = _this.fromPinWithName(pinName);\n              _context2.next = 8;\n              return _promise.default.all([fromPinPromise, toPinPromises]);\n\n            case 8:\n              _yield$Promise$all = _context2.sent;\n              _yield$Promise$all2 = (0, _slicedToArray2.default)(_yield$Promise$all, 1);\n              pinned = _yield$Promise$all2[0];\n              toPin = (0, _toConsumableArray2.default)(new _set.default((0, _concat.default)(_context = []).call(_context, (0, _toConsumableArray2.default)(pinned || []), objectKeys)));\n              return _context2.abrupt(\"return\", _this.pinWithName(pinName, toPin));\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  // Removes object and children keys from pin name\n  // Keeps the object and children pinned\n  _handleUnPinAllWithName: function (name\n  /*: string*/\n  , objects\n  /*: Array<ParseObject>*/\n  ) {\n    var _this2 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n      var localDatastore, pinName, promises, objectKeys, _iterator2, _step2, _objectKeys, _context3, parent, children, parentKey, pinned, _iterator3, _step3, objectKey, hasReference, key, pinnedObjects;\n\n      return _regenerator.default.wrap(function (_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _this2._getAllContents();\n\n            case 2:\n              localDatastore = _context4.sent;\n              pinName = _this2.getPinName(name);\n              promises = [];\n              objectKeys = [];\n              _iterator2 = _createForOfIteratorHelper(objects);\n\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  parent = _step2.value;\n                  children = _this2._getChildren(parent);\n                  parentKey = _this2.getKeyForObject(parent);\n\n                  (_objectKeys = objectKeys).push.apply(_objectKeys, (0, _concat.default)(_context3 = [parentKey]).call(_context3, (0, _toConsumableArray2.default)((0, _keys3.default)(children))));\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n\n              objectKeys = (0, _toConsumableArray2.default)(new _set.default(objectKeys));\n              pinned = localDatastore[pinName] || [];\n              pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\n                return !(0, _includes.default)(objectKeys).call(objectKeys, item);\n              });\n\n              if (pinned.length == 0) {\n                promises.push(_this2.unPinWithName(pinName));\n                delete localDatastore[pinName];\n              } else {\n                promises.push(_this2.pinWithName(pinName, pinned));\n                localDatastore[pinName] = pinned;\n              }\n\n              _iterator3 = _createForOfIteratorHelper(objectKeys);\n              _context4.prev = 13;\n\n              _iterator3.s();\n\n            case 15:\n              if ((_step3 = _iterator3.n()).done) {\n                _context4.next = 31;\n                break;\n              }\n\n              objectKey = _step3.value;\n              hasReference = false;\n              _context4.t0 = (0, _keys2.default)(_regenerator.default).call(_regenerator.default, localDatastore);\n\n            case 19:\n              if ((_context4.t1 = _context4.t0()).done) {\n                _context4.next = 28;\n                break;\n              }\n\n              key = _context4.t1.value;\n\n              if (!(key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX))) {\n                _context4.next = 26;\n                break;\n              }\n\n              pinnedObjects = localDatastore[key] || [];\n\n              if (!(0, _includes.default)(pinnedObjects).call(pinnedObjects, objectKey)) {\n                _context4.next = 26;\n                break;\n              }\n\n              hasReference = true;\n              return _context4.abrupt(\"break\", 28);\n\n            case 26:\n              _context4.next = 19;\n              break;\n\n            case 28:\n              if (!hasReference) {\n                promises.push(_this2.unPinWithName(objectKey));\n              }\n\n            case 29:\n              _context4.next = 15;\n              break;\n\n            case 31:\n              _context4.next = 36;\n              break;\n\n            case 33:\n              _context4.prev = 33;\n              _context4.t2 = _context4[\"catch\"](13);\n\n              _iterator3.e(_context4.t2);\n\n            case 36:\n              _context4.prev = 36;\n\n              _iterator3.f();\n\n              return _context4.finish(36);\n\n            case 39:\n              return _context4.abrupt(\"return\", _promise.default.all(promises));\n\n            case 40:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee2, null, [[13, 33, 36, 39]]);\n    }))();\n  },\n  // Retrieve all pointer fields from object recursively\n  _getChildren: function (object\n  /*: ParseObject*/\n  ) {\n    var encountered = {};\n\n    var json = object._toFullJSON(undefined, true);\n\n    for (var key in json) {\n      if (json[key] && json[key].__type && json[key].__type === 'Object') {\n        this._traverse(json[key], encountered);\n      }\n    }\n\n    return encountered;\n  },\n  _traverse: function (object\n  /*: any*/\n  , encountered\n  /*: any*/\n  ) {\n    if (!object.objectId) {\n      return;\n    } else {\n      var objectKey = this.getKeyForObject(object);\n\n      if (encountered[objectKey]) {\n        return;\n      }\n\n      encountered[objectKey] = object;\n    }\n\n    for (var key in object) {\n      var json = object[key];\n\n      if (!object[key]) {\n        json = object;\n      }\n\n      if (json.__type && json.__type === 'Object') {\n        this._traverse(json, encountered);\n      }\n    }\n  },\n  // Transform keys in pin name to objects\n  _serializeObjectsFromPinName: function (name\n  /*: string*/\n  ) {\n    var _this3 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {\n      var _context5, _concatInstanceProper, _context6;\n\n      var localDatastore, allObjects, key, pinName, pinned, promises, objects;\n      return _regenerator.default.wrap(function (_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return _this3._getAllContents();\n\n            case 2:\n              localDatastore = _context7.sent;\n              allObjects = [];\n\n              for (key in localDatastore) {\n                if ((0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.OBJECT_PREFIX)) {\n                  allObjects.push(localDatastore[key][0]);\n                }\n              }\n\n              if (name) {\n                _context7.next = 7;\n                break;\n              }\n\n              return _context7.abrupt(\"return\", allObjects);\n\n            case 7:\n              pinName = _this3.getPinName(name);\n              pinned = localDatastore[pinName];\n\n              if ((0, _isArray.default)(pinned)) {\n                _context7.next = 11;\n                break;\n              }\n\n              return _context7.abrupt(\"return\", []);\n\n            case 11:\n              promises = (0, _map.default)(pinned).call(pinned, function (objectKey) {\n                return _this3.fromPinWithName(objectKey);\n              });\n              _context7.next = 14;\n              return _promise.default.all(promises);\n\n            case 14:\n              objects = _context7.sent;\n              objects = (_concatInstanceProper = (0, _concat.default)(_context5 = [])).call.apply(_concatInstanceProper, (0, _concat.default)(_context6 = [_context5]).call(_context6, (0, _toConsumableArray2.default)(objects)));\n              return _context7.abrupt(\"return\", (0, _filter.default)(objects).call(objects, function (object) {\n                return object != null;\n              }));\n\n            case 17:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  },\n  // Replaces object pointers with pinned pointers\n  // The object pointers may contain old data\n  // Uses Breadth First Search Algorithm\n  _serializeObject: function (objectKey\n  /*: string*/\n  , localDatastore\n  /*: any*/\n  ) {\n    var _this4 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {\n      var LDS, root, queue, meta, uniqueId, nodeId, subTreeRoot, field, value, key, pointer;\n      return _regenerator.default.wrap(function (_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              LDS = localDatastore;\n\n              if (LDS) {\n                _context8.next = 5;\n                break;\n              }\n\n              _context8.next = 4;\n              return _this4._getAllContents();\n\n            case 4:\n              LDS = _context8.sent;\n\n            case 5:\n              if (!(!LDS[objectKey] || LDS[objectKey].length === 0)) {\n                _context8.next = 7;\n                break;\n              }\n\n              return _context8.abrupt(\"return\", null);\n\n            case 7:\n              root = LDS[objectKey][0];\n              queue = [];\n              meta = {};\n              uniqueId = 0;\n              meta[uniqueId] = root;\n              queue.push(uniqueId);\n\n              while (queue.length !== 0) {\n                nodeId = queue.shift();\n                subTreeRoot = meta[nodeId];\n\n                for (field in subTreeRoot) {\n                  value = subTreeRoot[field];\n\n                  if (value.__type && value.__type === 'Object') {\n                    key = _this4.getKeyForObject(value);\n\n                    if (LDS[key] && LDS[key].length > 0) {\n                      pointer = LDS[key][0];\n                      uniqueId++;\n                      meta[uniqueId] = pointer;\n                      subTreeRoot[field] = pointer;\n                      queue.push(uniqueId);\n                    }\n                  }\n                }\n              }\n\n              return _context8.abrupt(\"return\", root);\n\n            case 15:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  },\n  // Called when an object is save / fetched\n  // Update object pin value\n  _updateObjectIfPinned: function (object\n  /*: ParseObject*/\n  )\n  /*: Promise<void>*/\n  {\n    var _this5 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {\n      var objectKey, pinned;\n      return _regenerator.default.wrap(function (_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              if (_this5.isEnabled) {\n                _context9.next = 2;\n                break;\n              }\n\n              return _context9.abrupt(\"return\");\n\n            case 2:\n              objectKey = _this5.getKeyForObject(object);\n              _context9.next = 5;\n              return _this5.fromPinWithName(objectKey);\n\n            case 5:\n              pinned = _context9.sent;\n\n              if (!(!pinned || pinned.length === 0)) {\n                _context9.next = 8;\n                break;\n              }\n\n              return _context9.abrupt(\"return\");\n\n            case 8:\n              return _context9.abrupt(\"return\", _this5.pinWithName(objectKey, [object._toFullJSON()]));\n\n            case 9:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee5);\n    }))();\n  },\n  // Called when object is destroyed\n  // Unpin object and remove all references from pin names\n  // TODO: Destroy children?\n  _destroyObjectIfPinned: function (object\n  /*: ParseObject*/\n  ) {\n    var _this6 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6() {\n      var localDatastore, objectKey, pin, promises, key, pinned;\n      return _regenerator.default.wrap(function (_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              if (_this6.isEnabled) {\n                _context10.next = 2;\n                break;\n              }\n\n              return _context10.abrupt(\"return\");\n\n            case 2:\n              _context10.next = 4;\n              return _this6._getAllContents();\n\n            case 4:\n              localDatastore = _context10.sent;\n              objectKey = _this6.getKeyForObject(object);\n              pin = localDatastore[objectKey];\n\n              if (pin) {\n                _context10.next = 9;\n                break;\n              }\n\n              return _context10.abrupt(\"return\");\n\n            case 9:\n              promises = [_this6.unPinWithName(objectKey)];\n              delete localDatastore[objectKey];\n\n              for (key in localDatastore) {\n                if (key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX)) {\n                  pinned = localDatastore[key] || [];\n\n                  if ((0, _includes.default)(pinned).call(pinned, objectKey)) {\n                    pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\n                      return item !== objectKey;\n                    });\n\n                    if (pinned.length == 0) {\n                      promises.push(_this6.unPinWithName(key));\n                      delete localDatastore[key];\n                    } else {\n                      promises.push(_this6.pinWithName(key, pinned));\n                      localDatastore[key] = pinned;\n                    }\n                  }\n                }\n              }\n\n              return _context10.abrupt(\"return\", _promise.default.all(promises));\n\n            case 13:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee6);\n    }))();\n  },\n  // Update pin and references of the unsaved object\n  _updateLocalIdForObject: function (localId\n  /*: string*/\n  , object\n  /*: ParseObject*/\n  ) {\n    var _this7 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {\n      var _context11, _context12;\n\n      var localKey, objectKey, unsaved, promises, localDatastore, key, pinned;\n      return _regenerator.default.wrap(function (_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              if (_this7.isEnabled) {\n                _context13.next = 2;\n                break;\n              }\n\n              return _context13.abrupt(\"return\");\n\n            case 2:\n              localKey = (0, _concat.default)(_context11 = (0, _concat.default)(_context12 = \"\".concat(_LocalDatastoreUtils.OBJECT_PREFIX)).call(_context12, object.className, \"_\")).call(_context11, localId);\n              objectKey = _this7.getKeyForObject(object);\n              _context13.next = 6;\n              return _this7.fromPinWithName(localKey);\n\n            case 6:\n              unsaved = _context13.sent;\n\n              if (!(!unsaved || unsaved.length === 0)) {\n                _context13.next = 9;\n                break;\n              }\n\n              return _context13.abrupt(\"return\");\n\n            case 9:\n              promises = [_this7.unPinWithName(localKey), _this7.pinWithName(objectKey, unsaved)];\n              _context13.next = 12;\n              return _this7._getAllContents();\n\n            case 12:\n              localDatastore = _context13.sent;\n\n              for (key in localDatastore) {\n                if (key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX)) {\n                  pinned = localDatastore[key] || [];\n\n                  if ((0, _includes.default)(pinned).call(pinned, localKey)) {\n                    pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\n                      return item !== localKey;\n                    });\n                    pinned.push(objectKey);\n                    promises.push(_this7.pinWithName(key, pinned));\n                    localDatastore[key] = pinned;\n                  }\n                }\n              }\n\n              return _context13.abrupt(\"return\", _promise.default.all(promises));\n\n            case 15:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee7);\n    }))();\n  },\n\n  /**\r\n   * Updates Local Datastore from Server\r\n   *\r\n   * <pre>\r\n   * await Parse.LocalDatastore.updateFromServer();\r\n   * </pre>\r\n   *\r\n   * @function updateFromServer\r\n   * @name Parse.LocalDatastore.updateFromServer\r\n   * @static\r\n   */\n  updateFromServer: function () {\n    var _this8 = this;\n\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8() {\n      var _context14;\n\n      var localDatastore, keys, key, pointersHash, _i, _keys, _key, _key$split, _key$split2, className, objectId, queryPromises, responses, objects, pinPromises;\n\n      return _regenerator.default.wrap(function (_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              if (!(!_this8.checkIfEnabled() || _this8.isSyncing)) {\n                _context15.next = 2;\n                break;\n              }\n\n              return _context15.abrupt(\"return\");\n\n            case 2:\n              _context15.next = 4;\n              return _this8._getAllContents();\n\n            case 4:\n              localDatastore = _context15.sent;\n              keys = [];\n\n              for (key in localDatastore) {\n                if ((0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.OBJECT_PREFIX)) {\n                  keys.push(key);\n                }\n              }\n\n              if (!(keys.length === 0)) {\n                _context15.next = 9;\n                break;\n              }\n\n              return _context15.abrupt(\"return\");\n\n            case 9:\n              _this8.isSyncing = true;\n              pointersHash = {};\n              _i = 0, _keys = keys;\n\n            case 12:\n              if (!(_i < _keys.length)) {\n                _context15.next = 23;\n                break;\n              }\n\n              _key = _keys[_i]; // Ignore the OBJECT_PREFIX\n\n              _key$split = _key.split('_'), _key$split2 = (0, _slicedToArray2.default)(_key$split, 4), className = _key$split2[2], objectId = _key$split2[3]; // User key is split into [ 'Parse', 'LDS', '', 'User', 'objectId' ]\n\n              if (_key.split('_').length === 5 && _key.split('_')[3] === 'User') {\n                className = '_User';\n                objectId = _key.split('_')[4];\n              }\n\n              if (!(0, _startsWith.default)(objectId).call(objectId, 'local')) {\n                _context15.next = 18;\n                break;\n              }\n\n              return _context15.abrupt(\"continue\", 20);\n\n            case 18:\n              if (!(className in pointersHash)) {\n                pointersHash[className] = new _set.default();\n              }\n\n              pointersHash[className].add(objectId);\n\n            case 20:\n              _i++;\n              _context15.next = 12;\n              break;\n\n            case 23:\n              queryPromises = (0, _map.default)(_context14 = (0, _keys3.default)(pointersHash)).call(_context14, function (className) {\n                var objectIds = (0, _from.default)(pointersHash[className]);\n                var query = new _ParseQuery.default(className);\n                query.limit(objectIds.length);\n\n                if (objectIds.length === 1) {\n                  query.equalTo('objectId', objectIds[0]);\n                } else {\n                  query.containedIn('objectId', objectIds);\n                }\n\n                return (0, _find.default)(query).call(query);\n              });\n              _context15.prev = 24;\n              _context15.next = 27;\n              return _promise.default.all(queryPromises);\n\n            case 27:\n              responses = _context15.sent;\n              objects = (0, _concat.default)([]).apply([], responses);\n              pinPromises = (0, _map.default)(objects).call(objects, function (object) {\n                var objectKey = _this8.getKeyForObject(object);\n\n                return _this8.pinWithName(objectKey, object._toFullJSON());\n              });\n              _context15.next = 32;\n              return _promise.default.all(pinPromises);\n\n            case 32:\n              _this8.isSyncing = false;\n              _context15.next = 39;\n              break;\n\n            case 35:\n              _context15.prev = 35;\n              _context15.t0 = _context15[\"catch\"](24);\n              console.error('Error syncing LocalDatastore: ', _context15.t0);\n              _this8.isSyncing = false;\n\n            case 39:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee8, null, [[24, 35]]);\n    }))();\n  },\n  getKeyForObject: function (object\n  /*: any*/\n  ) {\n    var _context16, _context17;\n\n    var objectId = object.objectId || object._getId();\n\n    return (0, _concat.default)(_context16 = (0, _concat.default)(_context17 = \"\".concat(_LocalDatastoreUtils.OBJECT_PREFIX)).call(_context17, object.className, \"_\")).call(_context16, objectId);\n  },\n  getPinName: function (pinName\n  /*: ?string*/\n  ) {\n    if (!pinName || pinName === _LocalDatastoreUtils.DEFAULT_PIN) {\n      return _LocalDatastoreUtils.DEFAULT_PIN;\n    }\n\n    return _LocalDatastoreUtils.PIN_PREFIX + pinName;\n  },\n  checkIfEnabled: function () {\n    if (!this.isEnabled) {\n      console.error('Parse.enableLocalDatastore() must be called first');\n    }\n\n    return this.isEnabled;\n  }\n};\nmodule.exports = LocalDatastore;\n\n_CoreManager.default.setLocalDatastoreController(require('./LocalDatastoreController'));\n\n_CoreManager.default.setLocalDatastore(LocalDatastore);","map":{"version":3,"names":["_interopRequireDefault","require","_Array$isArray2","_getIteratorMethod","_Symbol","_Array$from2","_sliceInstanceProperty","_find","_from","_map","_isArray","_keys2","_startsWith","_keys3","_includes","_filter","_regenerator","_concat","_set","_toConsumableArray2","_promise","_slicedToArray2","_asyncToGenerator2","_CoreManager","_ParseQuery","_LocalDatastoreUtils","_createForOfIteratorHelper","o","allowArrayLike","it","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","return","minLen","_context18","_arrayLikeToArray","Object","prototype","toString","constructor","name","test","arr","len","arr2","Array","LocalDatastore","isEnabled","isSyncing","fromPinWithName","controller","default","getLocalDatastoreController","pinWithName","unPinWithName","_getAllContents","getAllContents","_getRawStorage","getRawStorage","_clear","clear","_handlePinAllWithName","objects","_this","mark","_callee","_context","pinName","toPinPromises","objectKeys","_iterator","_step","parent","children","parentKey","json","objectKey","fromPinPromise","_yield$Promise$all","_yield$Promise$all2","pinned","toPin","wrap","_context2","prev","getPinName","_getChildren","getKeyForObject","_toFullJSON","undefined","_localId","push","all","sent","abrupt","stop","_handleUnPinAllWithName","_this2","_callee2","localDatastore","promises","_iterator2","_step2","_objectKeys","_context3","_iterator3","_step3","hasReference","key","pinnedObjects","_context4","apply","item","t0","t1","DEFAULT_PIN","PIN_PREFIX","t2","finish","object","encountered","__type","_traverse","objectId","_serializeObjectsFromPinName","_this3","_callee3","_context5","_concatInstanceProper","_context6","allObjects","_context7","OBJECT_PREFIX","_serializeObject","_this4","_callee4","LDS","root","queue","meta","uniqueId","nodeId","subTreeRoot","field","pointer","_context8","shift","_updateObjectIfPinned","_this5","_callee5","_context9","_destroyObjectIfPinned","_this6","_callee6","pin","_context10","_updateLocalIdForObject","localId","_this7","_callee7","_context11","_context12","localKey","unsaved","_context13","concat","className","updateFromServer","_this8","_callee8","_context14","keys","pointersHash","_i","_keys","_key","_key$split","_key$split2","queryPromises","responses","pinPromises","_context15","checkIfEnabled","split","add","objectIds","query","limit","equalTo","containedIn","console","error","_context16","_context17","_getId","module","exports","setLocalDatastoreController","setLocalDatastore"],"sources":["C:/Users/brosk/Documents/Web Dev/modern-web-development-project/project/node_modules/parse/lib/browser/LocalDatastore.js"],"sourcesContent":["\"use strict\";\r\n\r\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\r\n\r\nvar _Array$isArray2 = require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\");\r\n\r\nvar _getIteratorMethod = require(\"@babel/runtime-corejs3/core-js/get-iterator-method\");\r\n\r\nvar _Symbol = require(\"@babel/runtime-corejs3/core-js-stable/symbol\");\r\n\r\nvar _Array$from2 = require(\"@babel/runtime-corejs3/core-js-stable/array/from\");\r\n\r\nvar _sliceInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\");\r\n\r\nvar _find = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/find\"));\r\n\r\nvar _from = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/from\"));\r\n\r\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\r\n\r\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\r\n\r\nvar _keys2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/keys\"));\r\n\r\nvar _startsWith = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/starts-with\"));\r\n\r\nvar _keys3 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\r\n\r\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\r\n\r\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\r\n\r\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\r\n\r\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\r\n\r\nvar _set = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set\"));\r\n\r\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/toConsumableArray\"));\r\n\r\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\r\n\r\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/slicedToArray\"));\r\n\r\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\r\n\r\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\r\n\r\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\r\n\r\nvar _LocalDatastoreUtils = require(\"./LocalDatastoreUtils\");\r\n\r\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\r\n  var it = typeof _Symbol !== \"undefined\" && _getIteratorMethod(o) || o[\"@@iterator\"];\r\n\r\n  if (!it) {\r\n    if (_Array$isArray2(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\r\n      if (it) o = it;\r\n      var i = 0;\r\n\r\n      var F = function () {};\r\n\r\n      return {\r\n        s: F,\r\n        n: function () {\r\n          if (i >= o.length) return {\r\n            done: true\r\n          };\r\n          return {\r\n            done: false,\r\n            value: o[i++]\r\n          };\r\n        },\r\n        e: function (_e) {\r\n          throw _e;\r\n        },\r\n        f: F\r\n      };\r\n    }\r\n\r\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\r\n  }\r\n\r\n  var normalCompletion = true,\r\n      didErr = false,\r\n      err;\r\n  return {\r\n    s: function () {\r\n      it = it.call(o);\r\n    },\r\n    n: function () {\r\n      var step = it.next();\r\n      normalCompletion = step.done;\r\n      return step;\r\n    },\r\n    e: function (_e2) {\r\n      didErr = true;\r\n      err = _e2;\r\n    },\r\n    f: function () {\r\n      try {\r\n        if (!normalCompletion && it.return != null) it.return();\r\n      } finally {\r\n        if (didErr) throw err;\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n  var _context18;\r\n\r\n  if (!o) return;\r\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\r\n\r\n  var n = _sliceInstanceProperty(_context18 = Object.prototype.toString.call(o)).call(_context18, 8, -1);\r\n\r\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\r\n  if (n === \"Map\" || n === \"Set\") return _Array$from2(o);\r\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n  if (len == null || len > arr.length) len = arr.length;\r\n\r\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n    arr2[i] = arr[i];\r\n  }\r\n\r\n  return arr2;\r\n}\r\n/**\r\n * Provides a local datastore which can be used to store and retrieve <code>Parse.Object</code>. <br />\r\n * To enable this functionality, call <code>Parse.enableLocalDatastore()</code>.\r\n *\r\n * Pin object to add to local datastore\r\n *\r\n * <pre>await object.pin();</pre>\r\n * <pre>await object.pinWithName('pinName');</pre>\r\n *\r\n * Query pinned objects\r\n *\r\n * <pre>query.fromLocalDatastore();</pre>\r\n * <pre>query.fromPin();</pre>\r\n * <pre>query.fromPinWithName();</pre>\r\n *\r\n * <pre>const localObjects = await query.find();</pre>\r\n *\r\n * @class Parse.LocalDatastore\r\n * @static\r\n */\r\n\r\n\r\nvar LocalDatastore = {\r\n  isEnabled: false,\r\n  isSyncing: false,\r\n  fromPinWithName: function (name\r\n  /*: string*/\r\n  )\r\n  /*: Promise<Array<Object>>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.fromPinWithName(name);\r\n  },\r\n  pinWithName: function (name\r\n  /*: string*/\r\n  , value\r\n  /*: any*/\r\n  )\r\n  /*: Promise<void>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.pinWithName(name, value);\r\n  },\r\n  unPinWithName: function (name\r\n  /*: string*/\r\n  )\r\n  /*: Promise<void>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.unPinWithName(name);\r\n  },\r\n  _getAllContents: function ()\r\n  /*: Promise<Object>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.getAllContents();\r\n  },\r\n  // Use for testing\r\n  _getRawStorage: function ()\r\n  /*: Promise<Object>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.getRawStorage();\r\n  },\r\n  _clear: function ()\r\n  /*: Promise<void>*/\r\n  {\r\n    var controller = _CoreManager.default.getLocalDatastoreController();\r\n\r\n    return controller.clear();\r\n  },\r\n  // Pin the object and children recursively\r\n  // Saves the object and children key to Pin Name\r\n  _handlePinAllWithName: function (name\r\n  /*: string*/\r\n  , objects\r\n  /*: Array<ParseObject>*/\r\n  )\r\n  /*: Promise<void>*/\r\n  {\r\n    var _this = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\r\n      var _context;\r\n\r\n      var pinName, toPinPromises, objectKeys, _iterator, _step, parent, children, parentKey, json, objectKey, fromPinPromise, _yield$Promise$all, _yield$Promise$all2, pinned, toPin;\r\n\r\n      return _regenerator.default.wrap(function (_context2) {\r\n        while (1) {\r\n          switch (_context2.prev = _context2.next) {\r\n            case 0:\r\n              pinName = _this.getPinName(name);\r\n              toPinPromises = [];\r\n              objectKeys = [];\r\n              _iterator = _createForOfIteratorHelper(objects);\r\n\r\n              try {\r\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\r\n                  parent = _step.value;\r\n                  children = _this._getChildren(parent);\r\n                  parentKey = _this.getKeyForObject(parent);\r\n                  json = parent._toFullJSON(undefined, true);\r\n\r\n                  if (parent._localId) {\r\n                    json._localId = parent._localId;\r\n                  }\r\n\r\n                  children[parentKey] = json;\r\n\r\n                  for (objectKey in children) {\r\n                    objectKeys.push(objectKey);\r\n                    toPinPromises.push(_this.pinWithName(objectKey, [children[objectKey]]));\r\n                  }\r\n                }\r\n              } catch (err) {\r\n                _iterator.e(err);\r\n              } finally {\r\n                _iterator.f();\r\n              }\r\n\r\n              fromPinPromise = _this.fromPinWithName(pinName);\r\n              _context2.next = 8;\r\n              return _promise.default.all([fromPinPromise, toPinPromises]);\r\n\r\n            case 8:\r\n              _yield$Promise$all = _context2.sent;\r\n              _yield$Promise$all2 = (0, _slicedToArray2.default)(_yield$Promise$all, 1);\r\n              pinned = _yield$Promise$all2[0];\r\n              toPin = (0, _toConsumableArray2.default)(new _set.default((0, _concat.default)(_context = []).call(_context, (0, _toConsumableArray2.default)(pinned || []), objectKeys)));\r\n              return _context2.abrupt(\"return\", _this.pinWithName(pinName, toPin));\r\n\r\n            case 13:\r\n            case \"end\":\r\n              return _context2.stop();\r\n          }\r\n        }\r\n      }, _callee);\r\n    }))();\r\n  },\r\n  // Removes object and children keys from pin name\r\n  // Keeps the object and children pinned\r\n  _handleUnPinAllWithName: function (name\r\n  /*: string*/\r\n  , objects\r\n  /*: Array<ParseObject>*/\r\n  ) {\r\n    var _this2 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\r\n      var localDatastore, pinName, promises, objectKeys, _iterator2, _step2, _objectKeys, _context3, parent, children, parentKey, pinned, _iterator3, _step3, objectKey, hasReference, key, pinnedObjects;\r\n\r\n      return _regenerator.default.wrap(function (_context4) {\r\n        while (1) {\r\n          switch (_context4.prev = _context4.next) {\r\n            case 0:\r\n              _context4.next = 2;\r\n              return _this2._getAllContents();\r\n\r\n            case 2:\r\n              localDatastore = _context4.sent;\r\n              pinName = _this2.getPinName(name);\r\n              promises = [];\r\n              objectKeys = [];\r\n              _iterator2 = _createForOfIteratorHelper(objects);\r\n\r\n              try {\r\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\r\n                  parent = _step2.value;\r\n                  children = _this2._getChildren(parent);\r\n                  parentKey = _this2.getKeyForObject(parent);\r\n\r\n                  (_objectKeys = objectKeys).push.apply(_objectKeys, (0, _concat.default)(_context3 = [parentKey]).call(_context3, (0, _toConsumableArray2.default)((0, _keys3.default)(children))));\r\n                }\r\n              } catch (err) {\r\n                _iterator2.e(err);\r\n              } finally {\r\n                _iterator2.f();\r\n              }\r\n\r\n              objectKeys = (0, _toConsumableArray2.default)(new _set.default(objectKeys));\r\n              pinned = localDatastore[pinName] || [];\r\n              pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\r\n                return !(0, _includes.default)(objectKeys).call(objectKeys, item);\r\n              });\r\n\r\n              if (pinned.length == 0) {\r\n                promises.push(_this2.unPinWithName(pinName));\r\n                delete localDatastore[pinName];\r\n              } else {\r\n                promises.push(_this2.pinWithName(pinName, pinned));\r\n                localDatastore[pinName] = pinned;\r\n              }\r\n\r\n              _iterator3 = _createForOfIteratorHelper(objectKeys);\r\n              _context4.prev = 13;\r\n\r\n              _iterator3.s();\r\n\r\n            case 15:\r\n              if ((_step3 = _iterator3.n()).done) {\r\n                _context4.next = 31;\r\n                break;\r\n              }\r\n\r\n              objectKey = _step3.value;\r\n              hasReference = false;\r\n              _context4.t0 = (0, _keys2.default)(_regenerator.default).call(_regenerator.default, localDatastore);\r\n\r\n            case 19:\r\n              if ((_context4.t1 = _context4.t0()).done) {\r\n                _context4.next = 28;\r\n                break;\r\n              }\r\n\r\n              key = _context4.t1.value;\r\n\r\n              if (!(key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX))) {\r\n                _context4.next = 26;\r\n                break;\r\n              }\r\n\r\n              pinnedObjects = localDatastore[key] || [];\r\n\r\n              if (!(0, _includes.default)(pinnedObjects).call(pinnedObjects, objectKey)) {\r\n                _context4.next = 26;\r\n                break;\r\n              }\r\n\r\n              hasReference = true;\r\n              return _context4.abrupt(\"break\", 28);\r\n\r\n            case 26:\r\n              _context4.next = 19;\r\n              break;\r\n\r\n            case 28:\r\n              if (!hasReference) {\r\n                promises.push(_this2.unPinWithName(objectKey));\r\n              }\r\n\r\n            case 29:\r\n              _context4.next = 15;\r\n              break;\r\n\r\n            case 31:\r\n              _context4.next = 36;\r\n              break;\r\n\r\n            case 33:\r\n              _context4.prev = 33;\r\n              _context4.t2 = _context4[\"catch\"](13);\r\n\r\n              _iterator3.e(_context4.t2);\r\n\r\n            case 36:\r\n              _context4.prev = 36;\r\n\r\n              _iterator3.f();\r\n\r\n              return _context4.finish(36);\r\n\r\n            case 39:\r\n              return _context4.abrupt(\"return\", _promise.default.all(promises));\r\n\r\n            case 40:\r\n            case \"end\":\r\n              return _context4.stop();\r\n          }\r\n        }\r\n      }, _callee2, null, [[13, 33, 36, 39]]);\r\n    }))();\r\n  },\r\n  // Retrieve all pointer fields from object recursively\r\n  _getChildren: function (object\r\n  /*: ParseObject*/\r\n  ) {\r\n    var encountered = {};\r\n\r\n    var json = object._toFullJSON(undefined, true);\r\n\r\n    for (var key in json) {\r\n      if (json[key] && json[key].__type && json[key].__type === 'Object') {\r\n        this._traverse(json[key], encountered);\r\n      }\r\n    }\r\n\r\n    return encountered;\r\n  },\r\n  _traverse: function (object\r\n  /*: any*/\r\n  , encountered\r\n  /*: any*/\r\n  ) {\r\n    if (!object.objectId) {\r\n      return;\r\n    } else {\r\n      var objectKey = this.getKeyForObject(object);\r\n\r\n      if (encountered[objectKey]) {\r\n        return;\r\n      }\r\n\r\n      encountered[objectKey] = object;\r\n    }\r\n\r\n    for (var key in object) {\r\n      var json = object[key];\r\n\r\n      if (!object[key]) {\r\n        json = object;\r\n      }\r\n\r\n      if (json.__type && json.__type === 'Object') {\r\n        this._traverse(json, encountered);\r\n      }\r\n    }\r\n  },\r\n  // Transform keys in pin name to objects\r\n  _serializeObjectsFromPinName: function (name\r\n  /*: string*/\r\n  ) {\r\n    var _this3 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {\r\n      var _context5, _concatInstanceProper, _context6;\r\n\r\n      var localDatastore, allObjects, key, pinName, pinned, promises, objects;\r\n      return _regenerator.default.wrap(function (_context7) {\r\n        while (1) {\r\n          switch (_context7.prev = _context7.next) {\r\n            case 0:\r\n              _context7.next = 2;\r\n              return _this3._getAllContents();\r\n\r\n            case 2:\r\n              localDatastore = _context7.sent;\r\n              allObjects = [];\r\n\r\n              for (key in localDatastore) {\r\n                if ((0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.OBJECT_PREFIX)) {\r\n                  allObjects.push(localDatastore[key][0]);\r\n                }\r\n              }\r\n\r\n              if (name) {\r\n                _context7.next = 7;\r\n                break;\r\n              }\r\n\r\n              return _context7.abrupt(\"return\", allObjects);\r\n\r\n            case 7:\r\n              pinName = _this3.getPinName(name);\r\n              pinned = localDatastore[pinName];\r\n\r\n              if ((0, _isArray.default)(pinned)) {\r\n                _context7.next = 11;\r\n                break;\r\n              }\r\n\r\n              return _context7.abrupt(\"return\", []);\r\n\r\n            case 11:\r\n              promises = (0, _map.default)(pinned).call(pinned, function (objectKey) {\r\n                return _this3.fromPinWithName(objectKey);\r\n              });\r\n              _context7.next = 14;\r\n              return _promise.default.all(promises);\r\n\r\n            case 14:\r\n              objects = _context7.sent;\r\n              objects = (_concatInstanceProper = (0, _concat.default)(_context5 = [])).call.apply(_concatInstanceProper, (0, _concat.default)(_context6 = [_context5]).call(_context6, (0, _toConsumableArray2.default)(objects)));\r\n              return _context7.abrupt(\"return\", (0, _filter.default)(objects).call(objects, function (object) {\r\n                return object != null;\r\n              }));\r\n\r\n            case 17:\r\n            case \"end\":\r\n              return _context7.stop();\r\n          }\r\n        }\r\n      }, _callee3);\r\n    }))();\r\n  },\r\n  // Replaces object pointers with pinned pointers\r\n  // The object pointers may contain old data\r\n  // Uses Breadth First Search Algorithm\r\n  _serializeObject: function (objectKey\r\n  /*: string*/\r\n  , localDatastore\r\n  /*: any*/\r\n  ) {\r\n    var _this4 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {\r\n      var LDS, root, queue, meta, uniqueId, nodeId, subTreeRoot, field, value, key, pointer;\r\n      return _regenerator.default.wrap(function (_context8) {\r\n        while (1) {\r\n          switch (_context8.prev = _context8.next) {\r\n            case 0:\r\n              LDS = localDatastore;\r\n\r\n              if (LDS) {\r\n                _context8.next = 5;\r\n                break;\r\n              }\r\n\r\n              _context8.next = 4;\r\n              return _this4._getAllContents();\r\n\r\n            case 4:\r\n              LDS = _context8.sent;\r\n\r\n            case 5:\r\n              if (!(!LDS[objectKey] || LDS[objectKey].length === 0)) {\r\n                _context8.next = 7;\r\n                break;\r\n              }\r\n\r\n              return _context8.abrupt(\"return\", null);\r\n\r\n            case 7:\r\n              root = LDS[objectKey][0];\r\n              queue = [];\r\n              meta = {};\r\n              uniqueId = 0;\r\n              meta[uniqueId] = root;\r\n              queue.push(uniqueId);\r\n\r\n              while (queue.length !== 0) {\r\n                nodeId = queue.shift();\r\n                subTreeRoot = meta[nodeId];\r\n\r\n                for (field in subTreeRoot) {\r\n                  value = subTreeRoot[field];\r\n\r\n                  if (value.__type && value.__type === 'Object') {\r\n                    key = _this4.getKeyForObject(value);\r\n\r\n                    if (LDS[key] && LDS[key].length > 0) {\r\n                      pointer = LDS[key][0];\r\n                      uniqueId++;\r\n                      meta[uniqueId] = pointer;\r\n                      subTreeRoot[field] = pointer;\r\n                      queue.push(uniqueId);\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n\r\n              return _context8.abrupt(\"return\", root);\r\n\r\n            case 15:\r\n            case \"end\":\r\n              return _context8.stop();\r\n          }\r\n        }\r\n      }, _callee4);\r\n    }))();\r\n  },\r\n  // Called when an object is save / fetched\r\n  // Update object pin value\r\n  _updateObjectIfPinned: function (object\r\n  /*: ParseObject*/\r\n  )\r\n  /*: Promise<void>*/\r\n  {\r\n    var _this5 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {\r\n      var objectKey, pinned;\r\n      return _regenerator.default.wrap(function (_context9) {\r\n        while (1) {\r\n          switch (_context9.prev = _context9.next) {\r\n            case 0:\r\n              if (_this5.isEnabled) {\r\n                _context9.next = 2;\r\n                break;\r\n              }\r\n\r\n              return _context9.abrupt(\"return\");\r\n\r\n            case 2:\r\n              objectKey = _this5.getKeyForObject(object);\r\n              _context9.next = 5;\r\n              return _this5.fromPinWithName(objectKey);\r\n\r\n            case 5:\r\n              pinned = _context9.sent;\r\n\r\n              if (!(!pinned || pinned.length === 0)) {\r\n                _context9.next = 8;\r\n                break;\r\n              }\r\n\r\n              return _context9.abrupt(\"return\");\r\n\r\n            case 8:\r\n              return _context9.abrupt(\"return\", _this5.pinWithName(objectKey, [object._toFullJSON()]));\r\n\r\n            case 9:\r\n            case \"end\":\r\n              return _context9.stop();\r\n          }\r\n        }\r\n      }, _callee5);\r\n    }))();\r\n  },\r\n  // Called when object is destroyed\r\n  // Unpin object and remove all references from pin names\r\n  // TODO: Destroy children?\r\n  _destroyObjectIfPinned: function (object\r\n  /*: ParseObject*/\r\n  ) {\r\n    var _this6 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6() {\r\n      var localDatastore, objectKey, pin, promises, key, pinned;\r\n      return _regenerator.default.wrap(function (_context10) {\r\n        while (1) {\r\n          switch (_context10.prev = _context10.next) {\r\n            case 0:\r\n              if (_this6.isEnabled) {\r\n                _context10.next = 2;\r\n                break;\r\n              }\r\n\r\n              return _context10.abrupt(\"return\");\r\n\r\n            case 2:\r\n              _context10.next = 4;\r\n              return _this6._getAllContents();\r\n\r\n            case 4:\r\n              localDatastore = _context10.sent;\r\n              objectKey = _this6.getKeyForObject(object);\r\n              pin = localDatastore[objectKey];\r\n\r\n              if (pin) {\r\n                _context10.next = 9;\r\n                break;\r\n              }\r\n\r\n              return _context10.abrupt(\"return\");\r\n\r\n            case 9:\r\n              promises = [_this6.unPinWithName(objectKey)];\r\n              delete localDatastore[objectKey];\r\n\r\n              for (key in localDatastore) {\r\n                if (key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX)) {\r\n                  pinned = localDatastore[key] || [];\r\n\r\n                  if ((0, _includes.default)(pinned).call(pinned, objectKey)) {\r\n                    pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\r\n                      return item !== objectKey;\r\n                    });\r\n\r\n                    if (pinned.length == 0) {\r\n                      promises.push(_this6.unPinWithName(key));\r\n                      delete localDatastore[key];\r\n                    } else {\r\n                      promises.push(_this6.pinWithName(key, pinned));\r\n                      localDatastore[key] = pinned;\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n\r\n              return _context10.abrupt(\"return\", _promise.default.all(promises));\r\n\r\n            case 13:\r\n            case \"end\":\r\n              return _context10.stop();\r\n          }\r\n        }\r\n      }, _callee6);\r\n    }))();\r\n  },\r\n  // Update pin and references of the unsaved object\r\n  _updateLocalIdForObject: function (localId\r\n  /*: string*/\r\n  , object\r\n  /*: ParseObject*/\r\n  ) {\r\n    var _this7 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {\r\n      var _context11, _context12;\r\n\r\n      var localKey, objectKey, unsaved, promises, localDatastore, key, pinned;\r\n      return _regenerator.default.wrap(function (_context13) {\r\n        while (1) {\r\n          switch (_context13.prev = _context13.next) {\r\n            case 0:\r\n              if (_this7.isEnabled) {\r\n                _context13.next = 2;\r\n                break;\r\n              }\r\n\r\n              return _context13.abrupt(\"return\");\r\n\r\n            case 2:\r\n              localKey = (0, _concat.default)(_context11 = (0, _concat.default)(_context12 = \"\".concat(_LocalDatastoreUtils.OBJECT_PREFIX)).call(_context12, object.className, \"_\")).call(_context11, localId);\r\n              objectKey = _this7.getKeyForObject(object);\r\n              _context13.next = 6;\r\n              return _this7.fromPinWithName(localKey);\r\n\r\n            case 6:\r\n              unsaved = _context13.sent;\r\n\r\n              if (!(!unsaved || unsaved.length === 0)) {\r\n                _context13.next = 9;\r\n                break;\r\n              }\r\n\r\n              return _context13.abrupt(\"return\");\r\n\r\n            case 9:\r\n              promises = [_this7.unPinWithName(localKey), _this7.pinWithName(objectKey, unsaved)];\r\n              _context13.next = 12;\r\n              return _this7._getAllContents();\r\n\r\n            case 12:\r\n              localDatastore = _context13.sent;\r\n\r\n              for (key in localDatastore) {\r\n                if (key === _LocalDatastoreUtils.DEFAULT_PIN || (0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.PIN_PREFIX)) {\r\n                  pinned = localDatastore[key] || [];\r\n\r\n                  if ((0, _includes.default)(pinned).call(pinned, localKey)) {\r\n                    pinned = (0, _filter.default)(pinned).call(pinned, function (item) {\r\n                      return item !== localKey;\r\n                    });\r\n                    pinned.push(objectKey);\r\n                    promises.push(_this7.pinWithName(key, pinned));\r\n                    localDatastore[key] = pinned;\r\n                  }\r\n                }\r\n              }\r\n\r\n              return _context13.abrupt(\"return\", _promise.default.all(promises));\r\n\r\n            case 15:\r\n            case \"end\":\r\n              return _context13.stop();\r\n          }\r\n        }\r\n      }, _callee7);\r\n    }))();\r\n  },\r\n\r\n  /**\r\n   * Updates Local Datastore from Server\r\n   *\r\n   * <pre>\r\n   * await Parse.LocalDatastore.updateFromServer();\r\n   * </pre>\r\n   *\r\n   * @function updateFromServer\r\n   * @name Parse.LocalDatastore.updateFromServer\r\n   * @static\r\n   */\r\n  updateFromServer: function () {\r\n    var _this8 = this;\r\n\r\n    return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8() {\r\n      var _context14;\r\n\r\n      var localDatastore, keys, key, pointersHash, _i, _keys, _key, _key$split, _key$split2, className, objectId, queryPromises, responses, objects, pinPromises;\r\n\r\n      return _regenerator.default.wrap(function (_context15) {\r\n        while (1) {\r\n          switch (_context15.prev = _context15.next) {\r\n            case 0:\r\n              if (!(!_this8.checkIfEnabled() || _this8.isSyncing)) {\r\n                _context15.next = 2;\r\n                break;\r\n              }\r\n\r\n              return _context15.abrupt(\"return\");\r\n\r\n            case 2:\r\n              _context15.next = 4;\r\n              return _this8._getAllContents();\r\n\r\n            case 4:\r\n              localDatastore = _context15.sent;\r\n              keys = [];\r\n\r\n              for (key in localDatastore) {\r\n                if ((0, _startsWith.default)(key).call(key, _LocalDatastoreUtils.OBJECT_PREFIX)) {\r\n                  keys.push(key);\r\n                }\r\n              }\r\n\r\n              if (!(keys.length === 0)) {\r\n                _context15.next = 9;\r\n                break;\r\n              }\r\n\r\n              return _context15.abrupt(\"return\");\r\n\r\n            case 9:\r\n              _this8.isSyncing = true;\r\n              pointersHash = {};\r\n              _i = 0, _keys = keys;\r\n\r\n            case 12:\r\n              if (!(_i < _keys.length)) {\r\n                _context15.next = 23;\r\n                break;\r\n              }\r\n\r\n              _key = _keys[_i]; // Ignore the OBJECT_PREFIX\r\n\r\n              _key$split = _key.split('_'), _key$split2 = (0, _slicedToArray2.default)(_key$split, 4), className = _key$split2[2], objectId = _key$split2[3]; // User key is split into [ 'Parse', 'LDS', '', 'User', 'objectId' ]\r\n\r\n              if (_key.split('_').length === 5 && _key.split('_')[3] === 'User') {\r\n                className = '_User';\r\n                objectId = _key.split('_')[4];\r\n              }\r\n\r\n              if (!(0, _startsWith.default)(objectId).call(objectId, 'local')) {\r\n                _context15.next = 18;\r\n                break;\r\n              }\r\n\r\n              return _context15.abrupt(\"continue\", 20);\r\n\r\n            case 18:\r\n              if (!(className in pointersHash)) {\r\n                pointersHash[className] = new _set.default();\r\n              }\r\n\r\n              pointersHash[className].add(objectId);\r\n\r\n            case 20:\r\n              _i++;\r\n              _context15.next = 12;\r\n              break;\r\n\r\n            case 23:\r\n              queryPromises = (0, _map.default)(_context14 = (0, _keys3.default)(pointersHash)).call(_context14, function (className) {\r\n                var objectIds = (0, _from.default)(pointersHash[className]);\r\n                var query = new _ParseQuery.default(className);\r\n                query.limit(objectIds.length);\r\n\r\n                if (objectIds.length === 1) {\r\n                  query.equalTo('objectId', objectIds[0]);\r\n                } else {\r\n                  query.containedIn('objectId', objectIds);\r\n                }\r\n\r\n                return (0, _find.default)(query).call(query);\r\n              });\r\n              _context15.prev = 24;\r\n              _context15.next = 27;\r\n              return _promise.default.all(queryPromises);\r\n\r\n            case 27:\r\n              responses = _context15.sent;\r\n              objects = (0, _concat.default)([]).apply([], responses);\r\n              pinPromises = (0, _map.default)(objects).call(objects, function (object) {\r\n                var objectKey = _this8.getKeyForObject(object);\r\n\r\n                return _this8.pinWithName(objectKey, object._toFullJSON());\r\n              });\r\n              _context15.next = 32;\r\n              return _promise.default.all(pinPromises);\r\n\r\n            case 32:\r\n              _this8.isSyncing = false;\r\n              _context15.next = 39;\r\n              break;\r\n\r\n            case 35:\r\n              _context15.prev = 35;\r\n              _context15.t0 = _context15[\"catch\"](24);\r\n              console.error('Error syncing LocalDatastore: ', _context15.t0);\r\n              _this8.isSyncing = false;\r\n\r\n            case 39:\r\n            case \"end\":\r\n              return _context15.stop();\r\n          }\r\n        }\r\n      }, _callee8, null, [[24, 35]]);\r\n    }))();\r\n  },\r\n  getKeyForObject: function (object\r\n  /*: any*/\r\n  ) {\r\n    var _context16, _context17;\r\n\r\n    var objectId = object.objectId || object._getId();\r\n\r\n    return (0, _concat.default)(_context16 = (0, _concat.default)(_context17 = \"\".concat(_LocalDatastoreUtils.OBJECT_PREFIX)).call(_context17, object.className, \"_\")).call(_context16, objectId);\r\n  },\r\n  getPinName: function (pinName\r\n  /*: ?string*/\r\n  ) {\r\n    if (!pinName || pinName === _LocalDatastoreUtils.DEFAULT_PIN) {\r\n      return _LocalDatastoreUtils.DEFAULT_PIN;\r\n    }\r\n\r\n    return _LocalDatastoreUtils.PIN_PREFIX + pinName;\r\n  },\r\n  checkIfEnabled: function () {\r\n    if (!this.isEnabled) {\r\n      console.error('Parse.enableLocalDatastore() must be called first');\r\n    }\r\n\r\n    return this.isEnabled;\r\n  }\r\n};\r\nmodule.exports = LocalDatastore;\r\n\r\n_CoreManager.default.setLocalDatastoreController(require('./LocalDatastoreController'));\r\n\r\n_CoreManager.default.setLocalDatastore(LocalDatastore);"],"mappings":"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"},"metadata":{},"sourceType":"script"}